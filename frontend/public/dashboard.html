<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔥 Solana Hot Pools Dashboard</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🔥</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .ticker-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(90deg, #1a1a2e 0%, #16213e 50%, #1a1a2e 100%);
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            z-index: 1000;
            overflow: hidden;
            height: 50px;
        }
        
        .ticker-content {
            display: flex;
            align-items: center;
            height: 100%;
            animation: scroll-left 30s linear infinite;
            white-space: nowrap;
        }
        
        .ticker-item {
            display: inline-flex;
            align-items: center;
            padding: 0 30px;
            color: white;
            font-size: 14px;
            font-weight: 500;
        }
        
        .ticker-item .coin-name {
            margin-right: 10px;
            color: #ffd700;
            font-weight: bold;
        }
        
        .ticker-item .coin-price {
            margin-right: 10px;
        }
        
        .ticker-item .coin-change {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .ticker-item .coin-change.positive {
            background: rgba(40, 167, 69, 0.2);
            color: #4ade80;
        }
        
        .ticker-item .coin-change.negative {
            background: rgba(220, 53, 69, 0.2);
            color: #f87171;
        }
        
        .ticker-label {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(90deg, #ffd700, #ffed4e);
            color: #1a1a2e;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 12px;
            z-index: 10;
            box-shadow: 0 2px 10px rgba(255, 215, 0, 0.3);
        }
        
        @keyframes scroll-left {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%);
            }
        }
        
        body.ticker-active {
            padding-top: 70px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-card .value {
            color: #333;
            font-size: 1.8em;
            font-weight: bold;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .pools-container, .details-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            height: fit-content;
        }
        
        .pools-header, .details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .pools-header h2, .details-header h2 {
            color: #333;
            font-size: 1.6em;
        }
        
        .refresh-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9em;
            transition: transform 0.2s;
        }
        
        .refresh-btn:hover {
            transform: scale(1.05);
        }
        
        .refresh-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .pool-list {
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .pool-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .pool-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .pool-list::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        
        .pool-list::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .pool-item {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .pool-item:hover, .pool-item.selected {
            border-color: #667eea;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }
        
        .pool-item.selected {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }
        
        .pool-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .pool-name {
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
        }
        
        .pool-badge {
            background: #28a745;
            color: white;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 0.75em;
            font-weight: bold;
        }
        
        .pool-mini-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 0.85em;
        }
        
        .mini-stat {
            color: #666;
        }
        
        .mini-stat strong {
            color: #333;
        }
        
        .details-content {
            padding: 20px 0;
        }
        
        .detail-section {
            margin-bottom: 25px;
        }
        
        .detail-section h3 {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }
        
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .detail-item {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .detail-label {
            color: #666;
            font-size: 0.85em;
            margin-bottom: 5px;
        }
        
        .detail-value {
            color: #333;
            font-size: 1.1em;
            font-weight: bold;
        }
        
        .price-chart {
            height: 200px;
            background: #f8f9fa;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            margin-top: 15px;
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }
        
        .action-btn {
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .buy-btn {
            background: #28a745;
            color: white;
        }
        
        .buy-btn:hover {
            background: #218838;
        }
        
        .sell-btn {
            background: #dc3545;
            color: white;
        }
        
        .sell-btn:hover {
            background: #c82333;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            background: #dc3545;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .no-selection {
            text-align: center;
            padding: 40px;
            color: #999;
        }
        
        .no-selection svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
        }
        
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .pools-container, .details-container {
                max-height: none;
            }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .detail-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="ticker-active">
    <div class="ticker-container">
        <div class="ticker-label">🚀 HOT PICKS</div>
        <div class="ticker-content" id="tickerContent">
            <!-- Ticker items will be dynamically added here -->
        </div>
    </div>
    
    <div class="container">
        <div class="header">
            <h1>🔥 Solana Hot Pools Dashboard</h1>
            <p>Real-time tracking and analysis of the hottest liquidity pools on Solana</p>
        </div>
        
        <div class="stats-container">
            <div class="stat-card">
                <h3>Active Pools</h3>
                <div class="value" id="poolCount">-</div>
            </div>
            <div class="stat-card">
                <h3>Total Volume 24h</h3>
                <div class="value" id="totalVolume">-</div>
            </div>
            <div class="stat-card">
                <h3>Top Gainer</h3>
                <div class="value" id="topGainer">-</div>
            </div>
            <div class="stat-card">
                <h3>Total Liquidity</h3>
                <div class="value" id="totalLiquidity">-</div>
            </div>
            <div class="stat-card">
                <h3>Last Update</h3>
                <div class="value" id="lastUpdate">-</div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="pools-container">
                <div class="pools-header">
                    <h2>🔥 Hot Pools</h2>
                    <button class="refresh-btn" onclick="fetchPools()">🔄 Refresh</button>
                </div>
                <div class="pool-list" id="poolsList">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading hot pools...</p>
                    </div>
                </div>
            </div>
            
            <div class="details-container">
                <div class="details-header">
                    <h2>📊 Pool Details</h2>
                </div>
                <div id="detailsContent">
                    <div class="no-selection">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                        <p>Select a pool to view detailed information</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const API_URL = 'http://localhost:8000';
        let currentPools = [];
        let selectedPool = null;
        let tickerPools = [];
        
        async function fetchPools() {
            console.log('Fetching pools from API...');
            const poolsList = document.getElementById('poolsList');
            const refreshBtn = document.querySelector('.refresh-btn');
            
            refreshBtn.disabled = true;
            
            if (currentPools.length === 0) {
                poolsList.innerHTML = '<div class="loading"><div class="spinner"></div><p>Loading hot pools...</p></div>';
            }
            
            try {
                const response = await fetch(`${API_URL}/api/hot-pools?limit=20`);
                console.log('Response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('Data received:', data);
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                currentPools = data.pools || data.data || [];
                displayPools(currentPools);
                updateStats(currentPools);
                updateTicker(currentPools);
                
                // If a pool was selected, update its details
                if (selectedPool) {
                    const updatedPool = currentPools.find(p => 
                        (p.address || p.pairAddress) === (selectedPool.address || selectedPool.pairAddress)
                    );
                    if (updatedPool) {
                        selectedPool = updatedPool;
                        showPoolDetails(updatedPool);
                    }
                }
                
            } catch (error) {
                console.error('Error fetching pools:', error);
                poolsList.innerHTML = `
                    <div class="error">
                        ❌ Error loading pools: ${error.message}
                        <br><br>
                        Make sure the backend server is running on port 8000.
                    </div>
                `;
            } finally {
                refreshBtn.disabled = false;
            }
        }
        
        function displayPools(pools) {
            const poolsList = document.getElementById('poolsList');
            
            if (!pools || pools.length === 0) {
                poolsList.innerHTML = '<div class="loading">No hot pools found. The API might be loading data...</div>';
                return;
            }
            
            const poolsHTML = pools.map((pool, index) => {
                const name = pool.name || pool.tokenName || pool.pair || `Pool ${index + 1}`;
                const address = pool.address || pool.pairAddress || pool.id || 'N/A';
                const volume = pool.volume24h || pool.volume || pool.volumeUSD || 0;
                const priceChange = pool.priceChange24h || pool.priceChange || pool.change24h || 0;
                const liquidity = pool.liquidity || pool.liquidityUSD || pool.tvl || 0;
                
                return `
                    <div class="pool-item ${selectedPool && (selectedPool.address || selectedPool.pairAddress) === address ? 'selected' : ''}" 
                         onclick="selectPool(${index})">
                        <div class="pool-item-header">
                            <span class="pool-name">${name}</span>
                            <span class="pool-badge">HOT 🔥</span>
                        </div>
                        <div class="pool-mini-stats">
                            <div class="mini-stat">Volume: <strong>$${formatNumber(volume)}</strong></div>
                            <div class="mini-stat">Liquidity: <strong>$${formatNumber(liquidity)}</strong></div>
                            <div class="mini-stat">24h: <strong style="color: ${priceChange >= 0 ? '#28a745' : '#dc3545'}">${priceChange >= 0 ? '+' : ''}${priceChange.toFixed(2)}%</strong></div>
                            <div class="mini-stat">Rank: <strong>#${index + 1}</strong></div>
                        </div>
                    </div>
                `;
            }).join('');
            
            poolsList.innerHTML = poolsHTML;
        }
        
        function selectPool(index) {
            selectedPool = currentPools[index];
            
            // Update selected state in UI
            document.querySelectorAll('.pool-item').forEach((item, i) => {
                if (i === index) {
                    item.classList.add('selected');
                } else {
                    item.classList.remove('selected');
                }
            });
            
            showPoolDetails(selectedPool);
        }
        
        function showPoolDetails(pool) {
            const detailsContent = document.getElementById('detailsContent');
            
            const name = pool.name || pool.tokenName || pool.pair || 'Unknown Pool';
            const address = pool.address || pool.pairAddress || pool.id || 'N/A';
            const volume = pool.volume24h || pool.volume || pool.volumeUSD || 0;
            const liquidity = pool.liquidity || pool.liquidityUSD || pool.tvl || 0;
            const priceChange = pool.priceChange24h || pool.priceChange || pool.change24h || 0;
            const price = pool.price || pool.priceUsd || 0;
            const txCount = pool.txCount || pool.transactions || 0;
            const holders = pool.holders || 0;
            const marketCap = pool.marketCap || pool.fdv || 0;
            
            detailsContent.innerHTML = `
                <div class="details-content">
                    <div class="detail-section">
                        <h3>Token Information</h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <div class="detail-label">Token Name</div>
                                <div class="detail-value">${name}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Contract Address</div>
                                <div class="detail-value" style="font-size: 0.9em; word-break: break-all;">
                                    ${address.slice(0, 10)}...${address.slice(-10)}
                                </div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Current Price</div>
                                <div class="detail-value">$${formatPrice(price)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">24h Change</div>
                                <div class="detail-value" style="color: ${priceChange >= 0 ? '#28a745' : '#dc3545'}">
                                    ${priceChange >= 0 ? '+' : ''}${priceChange.toFixed(2)}%
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h3>Market Metrics</h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <div class="detail-label">24h Volume</div>
                                <div class="detail-value">$${formatNumber(volume)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Total Liquidity</div>
                                <div class="detail-value">$${formatNumber(liquidity)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Market Cap</div>
                                <div class="detail-value">$${formatNumber(marketCap)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">24h Transactions</div>
                                <div class="detail-value">${formatNumber(txCount)}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h3>Price Chart (24h)</h3>
                        <div class="price-chart">
                            📈 Price chart visualization coming soon
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="action-btn buy-btn" onclick="alert('Trading feature coming soon!')">
                            Buy ${name.split('/')[0] || name}
                        </button>
                        <button class="action-btn sell-btn" onclick="alert('Trading feature coming soon!')">
                            Sell ${name.split('/')[0] || name}
                        </button>
                    </div>
                </div>
            `;
        }
        
        function updateStats(pools) {
            document.getElementById('poolCount').textContent = pools.length;
            
            const totalVolume = pools.reduce((sum, pool) => {
                const volume = pool.volume24h || pool.volume || pool.volumeUSD || 0;
                return sum + volume;
            }, 0);
            document.getElementById('totalVolume').textContent = '$' + formatNumber(totalVolume);
            
            const totalLiquidity = pools.reduce((sum, pool) => {
                const liquidity = pool.liquidity || pool.liquidityUSD || pool.tvl || 0;
                return sum + liquidity;
            }, 0);
            document.getElementById('totalLiquidity').textContent = '$' + formatNumber(totalLiquidity);
            
            // Find top gainer
            let topGainer = { name: 'N/A', change: 0 };
            pools.forEach(pool => {
                const change = pool.priceChange24h || pool.priceChange || pool.change24h || 0;
                if (change > topGainer.change) {
                    topGainer = {
                        name: pool.name || pool.tokenName || pool.pair || 'Unknown',
                        change: change
                    };
                }
            });
            
            if (topGainer.name !== 'N/A') {
                document.getElementById('topGainer').textContent = 
                    `${topGainer.name.split('/')[0].slice(0, 8)} +${topGainer.change.toFixed(1)}%`;
            } else {
                document.getElementById('topGainer').textContent = 'N/A';
            }
            
            const now = new Date();
            document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
        }
        
        function formatNumber(num) {
            if (num >= 1000000000) {
                return (num / 1000000000).toFixed(2) + 'B';
            } else if (num >= 1000000) {
                return (num / 1000000).toFixed(2) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(2) + 'K';
            }
            return num.toFixed(2);
        }
        
        function formatPrice(price) {
            if (price < 0.0001) {
                return price.toExponential(2);
            } else if (price < 1) {
                return price.toFixed(6);
            } else {
                return price.toFixed(2);
            }
        }
        
        function updateTicker(pools) {
            if (!pools || pools.length === 0) return;
            
            // Sort pools by volume and get top 10 for ticker
            tickerPools = [...pools]
                .sort((a, b) => {
                    const volA = a.volume24h || a.volume || a.volumeUSD || 0;
                    const volB = b.volume24h || b.volume || b.volumeUSD || 0;
                    return volB - volA;
                })
                .slice(0, 10);
            
            // Create ticker HTML with duplicated content for smooth scrolling
            const tickerItems = tickerPools.map(pool => {
                const name = pool.name || pool.tokenName || pool.pair || 'Unknown';
                const price = pool.price || pool.priceUsd || 0;
                const change = pool.priceChange24h || pool.priceChange || pool.change24h || 0;
                const changeClass = change >= 0 ? 'positive' : 'negative';
                const changeSymbol = change >= 0 ? '▲' : '▼';
                
                return `
                    <div class="ticker-item">
                        <span class="coin-name">${name.split('/')[0]}</span>
                        <span class="coin-price">$${formatPrice(price)}</span>
                        <span class="coin-change ${changeClass}">
                            ${changeSymbol} ${Math.abs(change).toFixed(2)}%
                        </span>
                    </div>
                `;
            }).join('');
            
            // Duplicate content for continuous scrolling
            const tickerContent = document.getElementById('tickerContent');
            tickerContent.innerHTML = tickerItems + tickerItems;
        }
        
        // Fetch pools on page load
        window.addEventListener('DOMContentLoaded', () => {
            console.log('Dashboard loaded, fetching pools...');
            fetchPools();
        });
        
        // Auto-refresh every 30 seconds
        setInterval(fetchPools, 30000);
    </script>
</body>
</html>